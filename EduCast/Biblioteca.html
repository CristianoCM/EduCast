<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

  	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" type="text/css" href="Biblioteca.css">

	<meta charset="utf-8">
	<title>EduCast - Acervo de Vídeos</title>
</head>
<body>

	<nav class="navbar navbar-expand-lg navbar-expand-md navbar-light bg-light">
	  <a class="navbar-brand" href="Main.html">
	    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRmqfbrxTA2rPM4c4WBE5dNth3ovxw2YbMrFXG5S4rFznAaJwkY" width="30" height="30" class="d-inline-block align-top" alt="Logomarca ícone">
	    Edu<span style="color: #33cccc;">Cast</span>
	  </a>
	  <div class="collapse navbar-collapse" id="navbarText">
	    <ul class="navbar-nav mr-auto">
	      <li class="nav-item active">
	        <a class="nav-link" href="#"><strong>Acervo</strong></a>
	      </li>
	      <li class="nav-item">
	        <a class="nav-link" href="Perfil.html" title="Acessar perfil do usuário">Perfil</a>
	      </li>
	      <li class="nav-item">
	        <a class="nav-link" href="Database/logout.php" title="Sair de sua conta">Sair</a>
	      </li>
	    </ul>
	  </div>
	  <form class="form-inline">
	  	<div class="container">
	  		<div class="row">
	  			<div class="col-lg-12 col-md-12 col-sm-12">
	  				<div class="input-group">
				  		<div class="input-group-btn search-panel">
						  	<button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown">
					        	<span id="search_concept">Conteúdo</span> <span class="caret"></span>
					        </button>
					        <ul class="dropdown-menu" role="menu">
					          <li><a href="#">Programação</a></li>
					          <li><a href="#">Redes</a></li>
					          <li><a href="#">Mobile</a></li>
					          <li><a href="#">Banco de Dados</a></li>
					          <li><a href="#">Hardware</a></li>
					          <li><hr style="margin-top: 5px; margin-bottom: 5px;"></li>
					          <li><a href="#">Todos</a></li>
					        </ul>
				    	</div>
					    <input class="form-control botao-buscar" type="search" placeholder="Buscar pelo título..." id="txtPesquisa">
					    <button class="btn btn-outline-info fa fa-search" type="submit" title="Buscar" onclick="return buscar()"></button>
					</div>
	  			</div>
	  		</div>
	  	</div>
	  </form>
	</nav>

	<div class="container-fluid">
		<hr style="background-color: white;">
		<div class="row">
			<div class="col-lg-12 col-md-12 col-sm-12 text-center">
				<strong>Assista a um conteúdo educacional <span style="color: #33cccc;">diversificado</span>, tudo em um só lugar!</strong><br>
				<span class="fa fa-diamond" style="color: #33cccc;"></span>
				<span class="fa fa-diamond"></span>
				<span class="fa fa-diamond" style="color: #33cccc;"></span>
			</div>
			<!--<div class="col-lg-4 col-md-4 col-sm-4">
				<div class="button-group">
			        <button type="button" class="btn btn-info btn-lg dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Gênero</button>
			        <ul class="dropdown-menu data-toggle generos">
			        	<li>
			        		<a href="#" data-value="computacao" tabIndex="-1"><input type="checkbox"/>&nbsp;Programação</a>
			        		<span class="borda-checks"></span>
			        		<a href="#" data-value="computacao" tabIndex="-1"><input type="checkbox"/>&nbsp;Mobile</a>
			        	</li>
			        	<li>
			        		<a href="#" data-value="historia" tabIndex="-1"><input type="checkbox"/>&nbsp;Redes</a>
			        	</li>
			        	<li>
			        		<a href="#" data-value="hardware" tabIndex="-1"><input type="checkbox"/>&nbsp;Hardware</a>
			        	</li>
			        </ul>
			    </div>
			</div>-->
		</div>
		<hr style="background-color: white;">
	</div>

	<section class="carousel slide" data-ride="carousel" id="populares">

		<div class="container">
	        <div class="row">
	            <div class="col-lg-12 col-md-12 col-sm-12">
	            	<h2>~ Populares ~</h2>
	            </div>
	        </div>
	        <div class="row">
	        	<div class="col-lg-5 col-md-4 col-sm-4"></div>
	            <div class="col-lg-2 col-md-4 col-sm-4 populares-setas">
	            	<a class="btn btn-outline-secondary prev seta-esquerda-pop" title="Itens Anteriores" id="popular_prev">
	            		<i class="fa fa-lg fa-chevron-left"></i>
	            	</a>
	            	<a class="btn btn-outline-secondary next seta-direita-pop" title="Itens Posteriores" id="popular_next">
	            		<i class="fa fa-lg fa-chevron-right"></i>
	            	</a>
	            	<div id="txtPopularesLimiteLast" style="display: none;">
	            		<span style="color: red;">Última página alcançada</span>
	            	</div>
	            	<div id="txtPopularesLimiteFirst" style="display: none;">
	            		<span style="color: red;">Primeira página alcançada</span>
	            	</div>
	            </div>
	            <div class="col-lg-5 col-md-4 col-sm-4"></div>
	        </div>
	        <br>
	    </div>

	    <div class="container-fluid">
			<div class="row">
				<div class="col-lg-1 col-md-1 col-sm-1"></div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="popular_titulo1"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoP1"></div>
					  	<div class="video" id="popular_video1">
						  	<a onclick="exibirVideoP(this)" id="aVideoP1">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="popular_duracao1"></span>
							<span class="badge badge-pill badge-light" id="popular_autor1"></span>
						</div>
						<div id="popular_tags1">
							
						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="popular_descricao1"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="popular_titulo2"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoP2"></div>
					  	<div class="video" id="popular_video2">
						  	<a onclick="exibirVideoP(this)" id="aVideoP2">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="popular_duracao2"></span>
							<span class="badge badge-pill badge-light" id="popular_autor2"></span>
						</div>
						<div id="popular_tags2">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="popular_descricao2"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="popular_titulo3"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoP3"></div>
					  	<div class="video" id="popular_video3">
						  	<a onclick="exibirVideoP(this)" id="aVideoP3">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="popular_duracao3"></span>
							<span class="badge badge-pill badge-light" id="popular_autor3"></span>
						</div>
						<div id="popular_tags3">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="popular_descricao3"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="popular_titulo4"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoP4"></div>
					  	<div class="video" id="popular_video4">
						  	<a onclick="exibirVideoP(this)" id="aVideoP4">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="popular_duracao4"></span>
							<span class="badge badge-pill badge-light" id="popular_autor4"></span>
						</div>
						<div id="popular_tags4">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="popular_descricao4"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="popular_titulo5"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoP5"></div>
					  	<div class="video" id="popular_video5">
						  	<a onclick="exibirVideoP(this)" id="aVideoP5">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="popular_duracao5"></span>
							<span class="badge badge-pill badge-light" id="popular_autor5"></span>
						</div>
						<div id="popular_tags5">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="popular_descricao5"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-1 col-md-1 col-sm-1"></div>
			</div>
		</div>

	</section>

	<br>

	<section class="carousel slide" data-ride="carousel" id="recentes">

		<div class="container">
	        <div class="row">
	            <div class="col-lg-12 col-md-12 col-sm-12">
	            	<h2>~ Novo Conteúdo ~</h2>
	            </div>
	        </div>
	        <div class="row">
	        	<div class="col-lg-5 col-md-4 col-sm-4"></div>
	            <div class="col-lg-2 col-md-4 col-sm-4 recentes-setas">
	            	<a class="btn btn-outline-secondary prev seta-esquerda-pop" title="Itens Anteriores" id="recentes_prev">
	            		<i class="fa fa-lg fa-chevron-left"></i>
	            	</a>
	            	<a class="btn btn-outline-secondary next seta-direita-pop" title="Itens Posteriores" id="recentes_next">
	            		<i class="fa fa-lg fa-chevron-right"></i>
	            	</a>
	            	<div id="txtRecentesLimiteLast" style="display: none;">
	            		<span style="color: red;">Última página alcançada</span>
	            	</div>
	            	<div id="txtRecentesLimiteFirst" style="display: none;">
	            		<span style="color: red;">Primeira página alcançada</span>
	            	</div>
	            </div>
	            <div class="col-lg-5 col-md-4 col-sm-4"></div>
	        </div>
	        <br>
	    </div>

	    <div class="container-fluid">
			<div class="row">
				<div class="col-lg-1 col-md-1 col-sm-1"></div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="recentes_titulo1"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoR1"></div>
					  	<div class="video" id="recentes_video1">
						  	<a onclick="exibirVideoR(this)" id="aVideoR1">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="recentes_duracao1"></span>
							<span class="badge badge-pill badge-light" id="recentes_autor1"></span>
						</div>
						<div id="recentes_tags1">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="recentes_descricao1"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="recentes_titulo2"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoR2"></div>
					  	<div class="video" id="recentes_video2">
						  	<a onclick="exibirVideoR(this)" id="aVideoR2">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="recentes_duracao2"></span>
							<span class="badge badge-pill badge-light" id="recentes_autor2"></span>
						</div>
						<div id="recentes_tags2">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="recentes_descricao2"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="recentes_titulo3"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoR3"></div>
					  	<div class="video" id="recentes_video3">
						  	<a onclick="exibirVideoR(this)" id="aVideoR3">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="recentes_duracao3"></span>
							<span class="badge badge-pill badge-light" id="recentes_autor3"></span>
						</div>
						<div id="recentes_tags3">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="recentes_descricao3"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="recentes_titulo4"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoR4"></div>
					  	<div class="video" id="recentes_video4">
						  	<a onclick="exibirVideoR(this)" id="aVideoR4">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="recentes_duracao4"></span>
							<span class="badge badge-pill badge-light" id="recentes_autor4"></span>
						</div>
						<div id="recentes_tags4">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="recentes_descricao4"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-2 col-md-4 col-sm-4">
					<div class="card text-white mb-3" style="max-width: 18rem;">
					  <div class="card-header" id="recentes_titulo5"></div>
					  <div class="card-body">
					  	<div style="display: none;" id="divVideoR5"></div>
					  	<div class="video" id="recentes_video5">
						  	<a onclick="exibirVideoR(this)" id="aVideoR5">
							  	<video loop muted preload="none" poster="">
							      <source src="" type="video/mp4">
							      Seu navegador não suporta a tag de vídeo HTML5.
							    </video>
						    </a>
						</div>
						<div class="video-info">
							<span class="badge badge-pill badge-light" id="recentes_duracao5"></span>
							<span class="badge badge-pill badge-light" id="recentes_autor5"></span>
						</div>
						<div id="recentes_tags5">

						</div>
					  </div>
					  <div class="card-footer">
					    <p class="card-text" id="recentes_descricao5"></p>
					  </div>
					</div>
				</div>

				<div class="col-lg-1 col-md-1 col-sm-1"></div>
			</div>
		</div>

	</section>

	<script type="text/javascript">
		var figure = $(".video").hover( hoverVideo, hideVideo );

		function hoverVideo(e) {
		    $('video', this).get(0).play();
		}

		function hideVideo(e) {
		    $('video', this).get(0).pause();
		}

		function fadeInElement(e) {
			e.fadeIn();
		}

		function fadeOutElement(e) {
			e.fadeOut();
		}

		$(document).ready(function(e) {
			verificarSessao();

		    $('.search-panel .dropdown-menu').find('a').click(function(e) {
				e.preventDefault();
				var param = $(this).attr("href").replace("#","");
				var concept = $(this).text();
				$('.search-panel span#search_concept').text(concept);
				$('.input-group #search_param').val(param);
			});
		});

		function verificarSessao() {
			$.ajax({
				type: "POST",
				url: 'Database/verificar_sessao.php',
				success: function(result) {
					if (result.length > 100)
						window.location.replace('Login.html');
				}
			});
		}

		function buscar() {
			window.location.replace('Busca.html?pesquisa=' + $('#txtPesquisa').val() + '&disciplina=' + $('.search-panel span#search_concept').text());
			return false;
		}

		function exibirVideoR(e) {
			var fE = e.id[e.id.length - 1];
			var vId = $("#divVideoR" + fE).html();
			window.location.replace('Exibicao.html?v=' + vId);
			return false;
		}

		function exibirVideoP(e) {
			var fE = e.id[e.id.length - 1];
			var vId = $("#divVideoP" + fE).html();
			window.location.replace('Exibicao.html?v=' + vId);
			return false;
		}

		var pag_popular;
		var pag_recentes;

		var popularNext = $('#popular_next').on('click', function() {
			pag_popular += 1;
			$('#txtPopularesLimiteFirst').hide();
			rodarAjaxConsulta('consulta_popular.php', pag_popular);
		});

		var popularPrev = $('#popular_prev').on('click', function() {
			$('#txtPopularesLimiteLast').hide();

			if (pag_popular > 0) {
				pag_popular -= 1;
				$('#txtPopularesLimiteFirst').hide();
			}
			else {
				$('#txtPopularesLimiteFirst').show();
				return;
			}

			rodarAjaxConsulta('consulta_popular.php', pag_popular);
		});

		var recentesNext = $('#recentes_next').on('click', function() {
			pag_recentes += 1;
			$('#txtRecentesLimiteFirst').hide();
			rodarAjaxConsulta('consulta_recente.php', pag_recentes);
		});

		var recentesPrev = $('#recentes_prev').on('click', function() {
			$('#txtRecentesLimiteLast').hide();

			if (pag_recentes > 0) {
				pag_recentes -= 1;
				$('#txtRecentesLimiteFirst').hide();
			}
			else {
				$('#txtRecentesLimiteFirst').show();
				return;
			}

			rodarAjaxConsulta('consulta_recente.php', pag_recentes);
		});

		window.onload = function() {
		  	pag_popular = 0; 	// 5 Primeiros vídeos do popular
		  	pag_recentes = 0;	// 5 Primeiros vídeos do recentes
		  	rodarAjaxConsulta('consulta_popular.php', pag_popular);
		  	rodarAjaxConsulta('consulta_recente.php', pag_recentes);
		};

		function rodarAjaxConsulta(arquivo_php, pag) {
			$.ajax({
				type: "POST",
				url: 'Database/' + arquivo_php,
				data: {page: pag},
				success: function(result) {
					var whatMatters = result.split("html>")[3].split("¬");
					//var tVect = vRes.length;

					//for (var i = tVect - 1; i >= tVect - 39; i--) {
					//	whatMatters.push(vRes[i]);
					//}

					var vez = 1;
					var id = 0;

					if (whatMatters.length == 1) {
						if (arquivo_php == "consulta_popular.php") {
							$('#txtPopularesLimiteLast').show();
							pag_popular -= 1;
						} else {
							$('#txtRecentesLimiteLast').show();
							pag_recentes -= 1;
						}
						return;
					}

					while (whatMatters.length < 41) {
						whatMatters.push("");
					}

					if (arquivo_php == "consulta_popular.php") {
						$("#populares").fadeOut(function() {
							if (whatMatters[1] != "NOPS") {
								$('#txtPopularesLimiteLast').hide();
								do {
									$("#divVideoP" + vez).html(whatMatters[id + 1]);
									$('#popular_titulo' + vez).html(whatMatters[id + 2]);
									$("#popular_duracao" + vez).html("<span style='color: #3399ff;'>Duração:</span> " + whatMatters[id + 4]);
								    $("#popular_video" + vez).html("<a onclick='exibirVideoP(this)' id='aVideoP" + vez + "'><video loop muted preload='none' poster='" + whatMatters[id + 5] + "'><source src='" + whatMatters[id + 6] + "' type='video/mp4'>Seu navegador não suporta a tag de vídeo HTML5.</video></a>");
								    $("#popular_descricao" + vez).html(whatMatters[id + 3]);

								    $("#popular_autor" + vez).html("<span style='color: #3399ff;'>Autor:</span> " + whatMatters[id + 7]);

								    var tag_vect = whatMatters[id + 8].split("|");
								    var tag_str = "";

								    for (var i = 0; i < tag_vect.length; i++) {
								    	tag_str += "<span class='badge badge-pill badge-dark'>" + tag_vect[i] + "</span>";
								    }

								    $("#popular_tags" + vez).html(tag_str);

								    id += 8;
								    vez += 1;
								} while (vez < 6);
							} else {
								$('#txtPopularesLimiteLast').show();
								pag_popular -= 1;
							}
							fadeInElement($("#populares"));
						});
					} else {
						$("#recentes").fadeOut(function() {
							if (whatMatters[1] != "NOPS") {
								$('#txtRecentesLimiteLast').hide();
								do {
									$("#divVideoR" + vez).html(whatMatters[id + 1]);
									$('#recentes_titulo' + vez).html(whatMatters[id + 2]);
									$("#recentes_duracao" + vez).html("<span style='color: #3399ff;'>Duração:</span> " + whatMatters[id + 4]);
								    $("#recentes_video" + vez).html("<a onclick='exibirVideoR(this)' id='aVideoR" + vez + "'><video loop muted preload='none' poster='" + whatMatters[id + 5] + "'><source src='" + whatMatters[id + 6] + "' type='video/mp4'>Seu navegador não suporta a tag de vídeo HTML5.</video></a>");
								    $("#recentes_descricao" + vez).html(whatMatters[id + 3]);

								    $("#recentes_autor" + vez).html("<span style='color: #3399ff;'>Autor:</span> " + whatMatters[id + 7]);

								    var tag_vect = whatMatters[id + 8].split("|");
								    var tag_str = "";
								    for (var i = 0; i < tag_vect.length; i++) {
								    	tag_str += "<span class='badge badge-pill badge-dark'>" + tag_vect[i] + "</span>";
								    }

								    $("#recentes_tags" + vez).html(tag_str);

								    id += 8;
								    vez += 1;
								} while (vez < 6);
							} else {
								$('#txtRecentesLimiteLast').show();
								pag_recentes -= 1;
							}

							fadeInElement($("#recentes"));
						});
					}
				}
			});
		}

	</script>

</body>
<footer>

	<br>

	<div class="container-fluid bg-light text-dark text-center rodape">
		<div class="row">
			<div class="col-lg-12 col-md-12 col-sm-12">
				<strong>Edu<span style="color: #33cccc;">Cast</span></strong><br>
          		Todos os direito reservados © 2018
			</div>
		</div>
	</div>

</footer>
</html>
